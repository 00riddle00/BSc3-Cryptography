def iter(M,k,f):
    r=M[1]
    l=M[0]^^eval(f)
    return [r,l]

def de_feistel(M, K, f):

    res = []

    for m in M:
        for k in K[::-1]:
            m=iter(m,k,f)
        res.append(m[::-1])

    return ''.join([chr(item) for sublist in res for item in sublist])

# UZD1
M1 = [[29, 70], [18, 82], [22, 84], [0, 72], [18, 84], [0, 68], [11, 94], [22, 84], [8, 65], [10, 94], [26, 66], [16, 81], [14, 73], [13, 80], [23, 82], [2, 72], [12, 76], [22, 83], [12, 79], [28, 95], [12, 72], [12, 79], [22, 93], [12, 73], [31, 68], [10, 94], [3, 94], [12, 76], [6, 74], [20, 86], [12, 76], [8, 66], [0, 72], [14, 66], [4, 68], [12, 76], [8, 66], [11, 94], [0, 72], [0, 75], [8, 78], [9, 92], [24, 83], [24, 86], [24, 87], [11, 80], [3, 86], [8, 76], [14, 78], [31, 78], [7, 66], [2, 72], [0, 68], [19, 87], [12, 84], [0, 75], [12, 84], [6, 64], [28, 86], [0, 75], [28, 86], [6, 73], [8, 78], [9, 92], [16, 83], [16, 86], [4, 64], [30, 84], [12, 84], [16, 86], [22, 82], [28, 86], [24, 86], [21, 80], [10, 82], [25, 70], [7, 78], [12, 81], [0, 73], [22, 82], [28, 86], [12, 87], [22, 81], [20, 86], [14, 70], [18, 82], [12, 73], [29, 70], [13, 80], [105, 44]]
K1 = [215, 224, 185]
f1 = '(r^k)&((k//16)|r)'

#print de_feistel(M1, K1, f1)


def xor(c1d_f, IV):
    m1_0 = IV[0] ^^ ord(c1d_f[0])
    m1_1 = IV[1] ^^ ord(c1d_f[1])
    return [m1_0, m1_1]


# UZD2
C2 = [[5, 86], [69, 15], [71, 75], [18, 5], [30, 64], [80, 17], [95, 72], [22, 17], [9, 81], [81, 6], [90, 71], [7, 14], [7, 81], [68, 27], [65, 72], [4, 6], [27, 64], [95, 3], [84, 83], [3, 23], [31, 68], [68, 9], [65, 67], [4, 8], [11, 76], [64, 31], [89, 67], [11, 12], [7, 85], [77, 30], [86, 74], [2, 5], [0, 78], [71, 22], [75, 65], [1, 15], [20, 68], [91, 12], [87, 77], [1, 22], [21, 71], [79, 6], [86, 88], [24, 15]]
IV2 = [7, 14]
K2 = [215, 224, 185]
f2 = '(r^k)&((k//16)|r)'

C2_1 = C2[0]
C2_2 = C2[1]
C2_3 = C2[2]
C2_4 = C2[3]

M = [[]]

for i in range(len(C2)):
    ci = C2[i]
    cid = de_feistel([ci], K2, f2)
    mi = xor(cid, IV2)
    IV2 = ci
    M.append(mi)
    
print ''.join([chr(item) for sublist in M for item in sublist])

    
   



    